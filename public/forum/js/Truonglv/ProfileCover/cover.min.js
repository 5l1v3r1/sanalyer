!function(b,e,f,g){XF.ProfileCover=XF.Element.newHandler({options:{cropper:{rotatable:!1,zoomable:!1,zoomOnTouch:!1,zoomOnWheel:!1,responsive:!0,viewMode:3,dragMode:"move",autoCropArea:1,guides:!1,modal:!1,cropBoxMovable:!0,cropBoxResizable:!1}},init:function(){this.$image=this.$target.find(".profileCover--img");var a=Math.max(this.$target.data("min-width"),this.$target.height()),c=this.$target.data("min-height");this.onRepositioning=!1;this.$target.hasClass("reposition")&&0<this.$image.length&&(a=
b.extend({minContainerWidth:a,minContainerHeight:c,minCanvasWidth:a,minCanvasHeight:c,minCropBoxWidth:a,minCropBoxHeight:c},this.options.cropper),this.$image.cropper(a),this.$target.find(".profileCover--save").on("click",b.proxy(this,"saveReposition")),this.onRepositioning=!0);this.lastWidth=0;this.onResizeHandler();b(e).onPassive("resize",b.proxy(this,"onResizeHandler"))},onResizeHandler:function(a){this.lastWidth==this.$target.width()||this.onRepositioning||(this.lastWidth=this.$target.width(),
this.$target.find(".profileCover-inner").height(this.$image.height()))},saveReposition:function(a){function c(a){d.prop("disabled",!1).removeClass("disabled");XF.redirect(a.redirect)}a.preventDefault();var d=b(a.currentTarget);d.prop("disabled",!0).addClass("disabled");this.$image.cropper("getCroppedCanvas",{width:this.$target.data("min-width"),height:this.$target.data("min-height"),imageSmoothingEnabled:!1}).toBlob(function(a){var b=new FormData;b.append("cover",a);b.append("reposition",1);XF.ajax("post",
d.data("url"),b,c)})}});XF.Element.register("profileCover","XF.ProfileCover")}(jQuery,this,document);