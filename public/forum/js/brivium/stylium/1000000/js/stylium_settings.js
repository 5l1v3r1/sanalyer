/** 
 * Copyright (c) 2014 Brivium (http://brivium.com)
 * Author: Brivium
 * Addon: StyliumFramework
 * Version: 1.0.1
 * Released under the Brivium License Agreement: http://brivium.com/pages/terms-of-use/
 */
 
 
/** @param {jQuery} $ jQuery Object */
!function(b,l,f,n){Stylium.StyliumSetting=function(a){this.__construct(a)};Stylium.StyliumSetting.prototype={__construct:function(a){this.$stylium=a;this.$container=a.find(".styliumSettingContainer");$this=this;b.cookie("stylium_setting_status")&&"disabled"!=b.cookie("stylium_setting_status")||a.removeClass("enabled").addClass("disabled");Stylium.StyliumSettingPosition(this.$stylium);this.dragging=!1;this.$container.find(".styliumMainTitle").bind({mousedown:b.context(this,"dragStart")});b(f).off("mouseup.styliumdragdrop").on("mouseup.styliumdragdrop",
b.context(this,"dragEnd"));b(l).resize(b.context(this,"responsiveInit"))},dragStart:function(a){var c=this.$stylium,e=c.offset(),g=Math.round(a.pageX-e.left),d=Math.round(a.pageY-(e.top-b(l).scrollTop()));c.addClass("dragging");b(f).on("mousemove.styliumdragdrop",function(a){c.css({top:a.pageY-d,left:a.pageX-g,right:"auto"});a.preventDefault()});this.dragging=!0},dragEnd:function(a){this.dragging&&(this.dragging=!1,b(f).off("mousemove.styliumdragdrop"),Stylium.StyliumSettingPosition(this.$stylium),
this.$stylium.removeClass("dragging"))},responsiveInit:function(a){Stylium.StyliumSettingPosition(this.$stylium)}};Stylium.StyliumSettingToggle=function(a){this.__construct(a)};Stylium.StyliumSettingToggle.prototype={__construct:function(a){this.$stylium=b("#styliumSetting");a.click(b.context(this,"toggleContainer"))},toggleContainer:function(a){a.preventDefault();$stylium=this.$stylium;$dir="left";a=$stylium.outerWidth();var c=parseInt($stylium.css($dir));$stylium.hasClass("enabled")?($stylium.removeClass("enabled"),
$stylium.hasClass("closeRight")&&0<c?$stylium.stop().animate({$dir:c+a},400,"easeInOutQuart"):$stylium.stop().animate({left:c-a},400,"easeInOutQuart"),($stylium.hasClass("overHeightRight")||$stylium.hasClass("overHeightLeft"))&&$stylium.find(".styliumBox.ctrlHandler").hide(),b.cookie("stylium_setting_status","disabled")):($stylium.find(".styliumBox.ctrlHandler").show(),$stylium.show(),$stylium.hasClass("closeRight")&&0<c?$stylium.stop().animate({$dir:c-a},400,"easeInOutQuart"):$stylium.stop().animate({$dir:c+
a},400,"easeInOutQuart"),b.cookie("stylium_setting_status","enabled"),$stylium.addClass("enabled"));Stylium.StyliumSettingPosition(this.$stylium)}};Stylium.StyliumSettingSave=function(a){this.__construct(a)};Stylium.StyliumSettingSave.prototype={__construct:function(a){this.$stylium=b("#styliumSetting");this.url=this.$stylium.attr("data-saveurl")||Stylium.StyliumSetting.getDefaultUrl();a.click(b.context(this,"saveSetting"));this.$trigger=a},saveSetting:function(a){$stylium=this.$stylium;$bodyBg=$stylium.find(".StyliumBodyBg.selected");
$bodyBg.length?($bodyBgSize=void 0!==$bodyBg.attr("data-size")?$bodyBg.attr("data-size"):"",$bodyBgImage=void 0!==$bodyBg.attr("data-image")?$bodyBg.attr("data-image"):Stylium.GetSettingValue("bodyBgImage"),$bodyBgRepeat=void 0!==$bodyBg.attr("data-repeat")?$bodyBg.attr("data-repeat"):"",$bodyBgPosition=void 0!==$bodyBg.attr("data-position")?$bodyBg.attr("data-position"):""):$bodyBgPosition=$bodyBgRepeat=$bodyBgImage=$bodyBgSize="";$settingValues={as_default:this.$trigger.attr("data-default"),style_id:$stylium.attr("data-styleid"),
style_id:$stylium.attr("data-styleid"),layout:$stylium.find(".styliumLayout").val(),font:$stylium.find(".styliumFont").val(),primaryColor:$stylium.find(".styliumPrimaryColor").attr("data-color"),secondaryColor:$stylium.find(".styliumSecondaryColor").attr("data-color"),tertiaryColor:$stylium.find(".styliumTertiaryColor").attr("data-color"),bodyBgColor:$stylium.find(".styliumBodyBackgroundColor").attr("data-color"),bodyBgSize:$bodyBgSize,bodyBgImage:$bodyBgImage,bodyBgRepeat:$bodyBgRepeat,bodyBgPosition:$bodyBgPosition};
this.xhr&&this.xhr.abort();this.$stylium.find(".saveComplete").addClass("processing");this.$stylium.find(".saveComplete .fa").removeClass("fa-check").addClass("fa-spinner fa-spin");this.xhr=XenForo.ajax(this.url,$settingValues,b.context(this,"saveComplete"),{})},saveComplete:function(a){this.xhr&&(this.xhr=!1);XenForo.hasResponseError(a)||this.$stylium.find(".saveComplete .fa").removeClass("fa-spinner fa-spin").addClass("fa-check")}};Stylium.StyliumSettingReset=function(a){this.__construct(a)};Stylium.StyliumSettingReset.prototype=
{__construct:function(a){this.$stylium=b("#styliumSetting");a.click(b.context(this,"resetSetting"))},resetSetting:function(a){$stylium=this.$stylium;Stylium.StyliumSettingValue($stylium,!1)}};Stylium.StyliumSettingRestore=function(a){this.__construct(a)};Stylium.StyliumSettingRestore.prototype={__construct:function(a){this.$stylium=b("#styliumSetting");this.url=this.$stylium.attr("data-restoreurl")||Stylium.StyliumSetting.getRestoreUrl();a.click(b.context(this,"restoreSetting"))},restoreSetting:function(a){$stylium=
this.$stylium;Stylium.StyliumSettingValue($stylium,!0);this.$stylium.find(".saveComplete").addClass("processing");this.$stylium.find(".saveComplete .fa").removeClass("fa-check").addClass("fa-spinner fa-spin");$settingValues={style_id:$stylium.attr("data-styleid")};this.xhr=XenForo.ajax(this.url,$settingValues,b.context(this,"complete"),{})},complete:function(a){this.xhr&&(this.xhr=!1);XenForo.hasResponseError(a)||this.$stylium.find(".saveComplete .fa").removeClass("fa-spinner fa-spin").addClass("fa-check")}};
Stylium.StyliumSetting.getDefaultUrl=function(){null===Stylium.StyliumSetting.defaultUrl&&(Stylium.StyliumSetting.defaultUrl="index.php?stylium/save&_xfResponseType=json");return Stylium.StyliumSetting.defaultUrl};Stylium.StyliumSetting.getRestoreUrl=function(){null===Stylium.StyliumSetting.restoreUrl&&(Stylium.StyliumSetting.restoreUrl="index.php?stylium/restore&_xfResponseType=json");return Stylium.StyliumSetting.restoreUrl};Stylium.StyliumSetting.defaultUrl=null;Stylium.StyliumSetting.restoreUrl=
null;Stylium.StyliumSettingValue=function(a,c){c||(c=!1);$settingOptions=Stylium.settingOptions;$elements=Stylium.settingElements;b.each($settingOptions,function(a,g){value=Stylium.GetSettingValue(a,c);if("bodyBgImage"==a)if(value){bodyBgImage=value;if(c&&"cover"==Stylium.GetSettingValue("bodyBgSize")){b.backstretch(bodyBgImage);return}if("cover"==Stylium.settingCustomValues.bodyBgSize||!Stylium.settingCustomValues.bodyBgImage&&"cover"==Stylium.GetSettingValue("bodyBgSize")){b.backstretch(bodyBgImage);
return}value="url("+value+")"}else b(".backstretch").remove();Stylium.SettingChange(a,value)});a=b("#styliumSetting");a.find(".styliumPrimaryColor").attr("data-color",Stylium.GetSettingValue("primaryColor",c));a.find(".styliumSecondaryColor").attr("data-color",Stylium.GetSettingValue("secondaryColor",c));a.find(".styliumTertiaryColor").attr("data-color",Stylium.GetSettingValue("tertiaryColor",c));a.find(".styliumBodyBackgroundColor").attr("data-color",Stylium.GetSettingValue("bodyBgColor",c));a.find(".styliumLayout").val(Stylium.GetSettingValue("layout",
c));b("body").removeClass("styliumWide").removeClass("styliumBoxedCover").removeClass("styliumBoxed").removeClass("styliumBoxed2");b("body").addClass(Stylium.GetSettingValue("layout",c));bodyBgImage=Stylium.GetSettingValue("bodyBgImage",c);a.find(".StyliumBodyBg").each(function(){b(this).attr("data-image")==Stylium.GetSettingValue("bodyBgImage",c)?b(this).addClass("selected"):b(this).removeClass("selected")})};Stylium.StyliumSettingPositionCtrlHeight=0;Stylium.StyliumSettingPosition=function(a){var c=
b(l),e=Stylium._winHeight,g=Stylium._winWidth,d=a.offset(),c=d.top-c.scrollTop();a.find(".styliumSettingToggle").outerWidth();var h=a.outerHeight(),f=a.outerWidth(),m=e-(c+h),k=g-(d.left+f),d=d.left;$ctrlHandler=a.find(".styliumBox.ctrlHandler");0<k&&0<d&&(d=d<k?0:g-f);if(0>m||0>k)c=0>m?e-h:c,d=0>k?g-f:d;if(0>c||0>d)c=0>c?0:c,d=0>d?0:d;if(a.hasClass("overHeightRight")||a.hasClass("overHeightLeft")){if(a.hasClass("overHeightRight")||a.hasClass("overHeightLeft"))0==d&&!XenForo.isRTL()||0!=d&&XenForo.isRTL()?
a.removeClass("overHeightRight").addClass("overHeightLeft"):a.removeClass("overHeightLeft").addClass("overHeightRight");e>h+Stylium.StyliumSettingPositionCtrlHeight&&a.removeClass("overHeightLeft").removeClass("overHeightRight")}else Stylium.StyliumSettingPositionCtrlHeight=a.find(".styliumBox.ctrlHandler").outerHeight(),e<h&&(0==d&&!XenForo.isRTL()||0!=d&&XenForo.isRTL()?a.removeClass("overHeightRight").addClass("overHeightLeft"):a.removeClass("overHeightLeft").addClass("overHeightRight"));0!=d&&
!XenForo.isRTL()||0==d&&XenForo.isRTL()?a.addClass("closeRight"):a.removeClass("closeRight");a.hasClass("enabled")?a.removeClass("disabled"):(a.addClass("disabled"),d=0==d?d-215:d+215);a.css({right:"auto"}).stop().animate({top:c,left:d},400,"easeInOutQuart")};Stylium.StyliumColPick=function(a){this.__construct(a)};Stylium.StyliumColPick.prototype={__construct:function(a){this.$colpick=a;$this=this;a.colpick({layout:"hex",color:a.attr("data-color"),colorScheme:"dark",onChange:function(a,e,g,d,f){b(d).attr("data-color",
"#"+e).css("background-color","#"+e);Stylium.SettingChange(b(d).attr("data-change"),"#"+e)},onSubmit:function(a,e,f,d){b(d).css("background-color","#"+e);Stylium.SettingChange(b(d).attr("data-change"),"#"+e);b(d).colpickHide()}})}};Stylium.StyliumFont=function(a){this.__construct(a)};Stylium.StyliumFont.prototype={__construct:function(a){this.$selector=a;a.change(b.context(this,"changeFont"))},changeFont:function(){var a="",a=this.$selector.val();fontType=this.$selector.find(":selected").parent("optgroup").attr("type");
Stylium.ChangeFont(a,fontType)}};Stylium.StyliumBodyBg=function(a){this.__construct(a)};Stylium.StyliumBodyBg.prototype={__construct:function(a){this.$element=a;$this=this;this.$element.click(b.context($this,"changeBackground"))},changeBackground:function(a){this.$element.hasClass("noneImage")?(b(".backstretch").remove(),Stylium.SettingChange("bodyBgImage","none"),b(".StyliumBodyBg").removeClass("selected")):($image=this.$element.attr("data-image"),$repeat=this.$element.attr("data-repeat"),$size=
this.$element.attr("data-size"),b(".StyliumBodyBg").removeClass("selected"),this.$element.addClass("selected"),"cover"==$size?b.backstretch($image):(b(".backstretch").remove(),Stylium.SettingChange("bodyBgImage","url("+$image+")"),Stylium.SettingChange("bodyBgPosition",Stylium.settingDefaultValues.bodyBgPosition),$size?Stylium.SettingChange("bodyBgSize",$size):Stylium.SettingChange("bodyBgSize",Stylium.settingDefaultValues.bodyBgSize),$repeat?Stylium.SettingChange("bodyBgRepeat",$repeat):Stylium.SettingChange("bodyBgRepeat",
Stylium.settingDefaultValues.bodyBgRepeat)))}};Stylium.StyliumLayout=function(a){a.change(function(){a.find("option").each(function(){b(this).val()==a.val()?b("body").addClass(b(this).val()):b("body").removeClass(b(this).val());Stylium.StickyElement.StackSpacer=0;b(".styliumStickyTop").each(function(){Stylium.StickyElement(b(this))})})})};XenForo.register("#styliumSetting","Stylium.StyliumSetting");XenForo.register(".styliumColPick","Stylium.StyliumColPick");XenForo.register(".styliumFont","Stylium.StyliumFont");
XenForo.register(".StyliumBodyBg","Stylium.StyliumBodyBg");XenForo.register(".styliumLayout","Stylium.StyliumLayout");XenForo.register(".styliumSettingToggle","Stylium.StyliumSettingToggle");XenForo.register(".styliumSettingSave","Stylium.StyliumSettingSave");XenForo.register(".styliumSettingReset","Stylium.StyliumSettingReset");XenForo.register(".styliumSettingRestore","Stylium.StyliumSettingRestore")}(jQuery,this,document);